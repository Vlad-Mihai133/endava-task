2025-08-22 22:17:40.156 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
PRAGMA journal_mode = 'wal';
2025-08-22 22:17:40.188 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-22 22:17:40.194 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-22 22:17:40.200 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsLock" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK___EFMigrationsLock" PRIMARY KEY,
    "Timestamp" TEXT NOT NULL
);
2025-08-22 22:17:40.203 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-22 19:17:40.2010961+00:00');
SELECT changes();
2025-08-22 22:17:40.242 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-22 22:17:40.249 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-22 22:17:40.251 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-22 22:17:40.258 +03:00 [INF] Applying migration '20250822191724_Init'.
2025-08-22 22:17:40.270 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Owners" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_Owners" PRIMARY KEY AUTOINCREMENT,
    "Name" TEXT NOT NULL,
    "Email" TEXT NULL
);
2025-08-22 22:17:40.271 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Cars" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_Cars" PRIMARY KEY AUTOINCREMENT,
    "Vin" TEXT NOT NULL,
    "Make" TEXT NULL,
    "Model" TEXT NULL,
    "YearOfManufacture" INTEGER NOT NULL,
    "OwnerId" INTEGER NOT NULL,
    CONSTRAINT "FK_Cars_Owners_OwnerId" FOREIGN KEY ("OwnerId") REFERENCES "Owners" ("Id") ON DELETE CASCADE
);
2025-08-22 22:17:40.271 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Claims" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_Claims" PRIMARY KEY AUTOINCREMENT,
    "CarId" INTEGER NOT NULL,
    "ClaimDate" TEXT NOT NULL,
    "Description" TEXT NOT NULL,
    "Amount" INTEGER NOT NULL,
    CONSTRAINT "FK_Claims_Cars_CarId" FOREIGN KEY ("CarId") REFERENCES "Cars" ("Id") ON DELETE CASCADE
);
2025-08-22 22:17:40.271 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "Policies" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_Policies" PRIMARY KEY AUTOINCREMENT,
    "CarId" INTEGER NOT NULL,
    "Provider" TEXT NULL,
    "StartDate" TEXT NOT NULL,
    "EndDate" TEXT NOT NULL,
    CONSTRAINT "FK_Policies_Cars_CarId" FOREIGN KEY ("CarId") REFERENCES "Cars" ("Id") ON DELETE CASCADE
);
2025-08-22 22:17:40.271 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ProcessedPolicyExpirations" (
    "Id" INTEGER NOT NULL CONSTRAINT "PK_ProcessedPolicyExpirations" PRIMARY KEY AUTOINCREMENT,
    "PolicyId" INTEGER NOT NULL,
    "ProcessedAt" TEXT NOT NULL,
    CONSTRAINT "FK_ProcessedPolicyExpirations_Policies_PolicyId" FOREIGN KEY ("PolicyId") REFERENCES "Policies" ("Id") ON DELETE CASCADE
);
2025-08-22 22:17:40.271 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Cars_OwnerId" ON "Cars" ("OwnerId");
2025-08-22 22:17:40.271 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_Cars_Vin" ON "Cars" ("Vin");
2025-08-22 22:17:40.272 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Claims_CarId" ON "Claims" ("CarId");
2025-08-22 22:17:40.272 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_Policies_CarId" ON "Policies" ("CarId");
2025-08-22 22:17:40.272 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_ProcessedPolicyExpirations_PolicyId" ON "ProcessedPolicyExpirations" ("PolicyId");
2025-08-22 22:17:40.272 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20250822191724_Init', '9.0.5');
2025-08-22 22:17:40.277 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-22 22:17:45.669 +03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-08-22 22:17:45.726 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsLock' AND "type" = 'table';
2025-08-22 22:17:45.739 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT OR IGNORE INTO "__EFMigrationsLock"("Id", "Timestamp") VALUES(1, '2025-08-22 19:17:45.7323059+00:00');
SELECT changes();
2025-08-22 22:17:45.780 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" TEXT NOT NULL CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY,
    "ProductVersion" TEXT NOT NULL
);
2025-08-22 22:17:45.785 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*) FROM "sqlite_master" WHERE "name" = '__EFMigrationsHistory' AND "type" = 'table';
2025-08-22 22:17:45.788 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-08-22 22:17:45.794 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-08-22 22:17:45.797 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DELETE FROM "__EFMigrationsLock";
2025-08-22 22:17:45.953 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Owners" AS "o")
2025-08-22 22:17:46.057 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 19), @p1='?' (Size = 7)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Owners" ("Email", "Name")
VALUES (@p0, @p1)
RETURNING "Id";
2025-08-22 22:17:46.066 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 26), @p1='?' (Size = 14)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Owners" ("Email", "Name")
VALUES (@p0, @p1)
RETURNING "Id";
2025-08-22 22:17:46.102 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 5), @p1='?' (Size = 5), @p2='?' (DbType = Int64), @p3='?' (Size = 8), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Cars" ("Make", "Model", "OwnerId", "Vin", "YearOfManufacture")
VALUES (@p0, @p1, @p2, @p3, @p4)
RETURNING "Id";
2025-08-22 22:17:46.106 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 2), @p1='?' (Size = 4), @p2='?' (DbType = Int64), @p3='?' (Size = 8), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Cars" ("Make", "Model", "OwnerId", "Vin", "YearOfManufacture")
VALUES (@p0, @p1, @p2, @p3, @p4)
RETURNING "Id";
2025-08-22 22:17:46.124 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = DateTime), @p2='?' (Size = 7), @p3='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Policies" ("CarId", "EndDate", "Provider", "StartDate")
VALUES (@p0, @p1, @p2, @p3)
RETURNING "Id";
2025-08-22 22:17:46.129 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = DateTime), @p2='?' (Size = 8), @p3='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Policies" ("CarId", "EndDate", "Provider", "StartDate")
VALUES (@p0, @p1, @p2, @p3)
RETURNING "Id";
2025-08-22 22:17:46.131 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = DateTime), @p2='?' (Size = 7), @p3='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Policies" ("CarId", "EndDate", "Provider", "StartDate")
VALUES (@p0, @p1, @p2, @p3)
RETURNING "Id";
2025-08-22 22:17:46.151 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int64), @p2='?' (DbType = DateTime), @p3='?' (Size = 32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Claims" ("Amount", "CarId", "ClaimDate", "Description")
VALUES (@p0, @p1, @p2, @p3)
RETURNING "Id";
2025-08-22 22:17:46.154 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int64), @p2='?' (DbType = DateTime), @p3='?' (Size = 17)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Claims" ("Amount", "CarId", "ClaimDate", "Description")
VALUES (@p0, @p1, @p2, @p3)
RETURNING "Id";
2025-08-22 22:17:46.361 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='?' (DbType = DateTime), @__AddHours_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT "p"."Id", "p"."CarId", "p"."EndDate", "p"."Provider", "p"."StartDate"
FROM "Policies" AS "p"
WHERE "p"."EndDate" <= @__now_0 AND "p"."EndDate" >= @__AddHours_1
2025-08-22 22:17:46.387 +03:00 [INF] Now listening on: https://localhost:61341
2025-08-22 22:17:46.388 +03:00 [INF] Now listening on: http://localhost:61342
2025-08-22 22:17:46.457 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-08-22 22:17:46.458 +03:00 [INF] Hosting environment: Development
2025-08-22 22:17:46.458 +03:00 [INF] Content root path: C:\Work\Endava\Task\CarInsurance.Api
2025-08-22 22:17:47.783 +03:00 [INF] Request starting HTTP/2 GET https://localhost:61341/ - null null
2025-08-22 22:17:47.940 +03:00 [INF] Request finished HTTP/2 GET https://localhost:61341/ - 404 0 null 165.1921ms
2025-08-22 22:17:47.945 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:61341/, Response status code: 404
2025-08-22 22:17:50.654 +03:00 [INF] Request starting HTTP/2 GET https://localhost:61341/swagger/index.html - null null
2025-08-22 22:17:50.723 +03:00 [INF] Request finished HTTP/2 GET https://localhost:61341/swagger/index.html - 200 null text/html;charset=utf-8 69.042ms
2025-08-22 22:17:50.773 +03:00 [INF] Request starting HTTP/2 GET https://localhost:61341/_framework/aspnetcore-browser-refresh.js - null null
2025-08-22 22:17:50.781 +03:00 [INF] Request finished HTTP/2 GET https://localhost:61341/_framework/aspnetcore-browser-refresh.js - 200 13768 application/javascript; charset=utf-8 8.6195ms
2025-08-22 22:17:50.796 +03:00 [INF] Request starting HTTP/2 GET https://localhost:61341/_vs/browserLink - null null
2025-08-22 22:17:51.104 +03:00 [INF] Request finished HTTP/2 GET https://localhost:61341/_vs/browserLink - 200 null text/javascript; charset=UTF-8 308.1121ms
2025-08-22 22:17:51.180 +03:00 [INF] Request starting HTTP/2 GET https://localhost:61341/swagger/v1/swagger.json - null null
2025-08-22 22:17:51.194 +03:00 [INF] Request finished HTTP/2 GET https://localhost:61341/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 14.5425ms
2025-08-22 22:17:59.167 +03:00 [INF] Request starting HTTP/2 GET https://localhost:61341/api/cars - null null
2025-08-22 22:17:59.172 +03:00 [INF] Executing endpoint 'CarInsurance.Api.Controllers.CarsController.GetCars (CarInsurance.Api)'
2025-08-22 22:17:59.192 +03:00 [INF] Route matched with {action = "GetCars", controller = "Cars"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarInsurance.Api.Dtos.CarDto]]] GetCars() on controller CarInsurance.Api.Controllers.CarsController (CarInsurance.Api).
2025-08-22 22:17:59.266 +03:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "c"."Id", "c"."Vin", "c"."Make", "c"."Model", "c"."YearOfManufacture", "c"."OwnerId", "o"."Name", "o"."Email"
FROM "Cars" AS "c"
INNER JOIN "Owners" AS "o" ON "c"."OwnerId" = "o"."Id"
2025-08-22 22:17:59.274 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarInsurance.Api.Dtos.CarDto, CarInsurance.Api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-08-22 22:17:59.287 +03:00 [INF] Executed action CarInsurance.Api.Controllers.CarsController.GetCars (CarInsurance.Api) in 90.2345ms
2025-08-22 22:17:59.287 +03:00 [INF] Executed endpoint 'CarInsurance.Api.Controllers.CarsController.GetCars (CarInsurance.Api)'
2025-08-22 22:17:59.291 +03:00 [INF] Request finished HTTP/2 GET https://localhost:61341/api/cars - 200 null application/json; charset=utf-8 124.4656ms
